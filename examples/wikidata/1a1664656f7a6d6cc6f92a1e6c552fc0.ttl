@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema: <https://schema.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .

<https://www.wikidata.org#query-1a1664656f7a6d6cc6f92a1e6c552fc0> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org/wiki/User:Japastorsanchez/BID-SPARQL>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  rdfs:comment "Identificación de macroclases, estadísticas de número de clases y número de ítems de cada macroclase (Harry Potter)"@en;
  sh:prefixes <https://example.org/to_decide/wikidata_prefixes>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?macro (COUNT(DISTINCT ?clase) as ?num_clases) (COUNT(DISTINCT ?item) AS ?total_items) WHERE {
    ?item wdt:P1080 wd:Q5410773 .
    ?item wdt:P31|wdt:P279|wdt:P361 ?clase .
    ?clase wdt:P279 ?superclase .
  SERVICE wikibase:label {bd:serviceParam wikibase:language \"es\",\"en\" .}
  BIND(
        IF(?clase IN (wd:Q66118879,wd:Q15298259,wd:Q181291,wd:Q1462606,wd:Q95074,wd:Q9303881,wd:Q5641611,wd:Q1056391,wd:Q2593744,wd:Q2338879,wd:Q15632617,wd:Q61002,wd:Q28020127,
          wd:Q2595584,wd:Q2753115,wd:Q12372870,wd:Q30174902,wd:Q20085850,wd:Q1569167,wd:Q3953096,wd:Q2087138,wd:Q5,wd:Q30061299,wd:Q1124812,wd:Q42056878,wd:Q5575572,
          wd:Q30167705,wd:Q3658341,wd:Q30147469,wd:Q17427986,wd:Q33295419,wd:Q33295822,wd:Q61750569,wd:Q33297169,wd:Q112242467,wd:Q154224,wd:Q2607197,wd:Q148401,wd:Q830248,
          wd:Q20529153,wd:Q33179355,wd:Q3375722,wd:Q6133514,wd:Q30174967,wd:Q15773347,wd:Q24286894), \"PER\", 
        IF(?clase IN (wd:Q4164871,wd:Q1931388,wd:Q1077857,wd:Q15635173,wd:Q247297,wd:Q4197743,wd:Q127843),\"PER-AT\",
        IF(?clase IN (wd:Q1791627,wd:Q13406463,wd:Q63032896),\"WIKIS\",
        IF(?clase IN (wd:Q5446565,wd:Q16979650,wd:Q6092436,wd:Q24577840,wd:Q3303128,wd:Q14514600,wd:Q3758946,wd:Q3967406,wd:Q21130150,wd:Q12271627,wd:Q112120197,wd:Q12713690,
          wd:Q60390514,wd:Q14623646,wd:Q933971,wd:Q56850094,wd:Q55586013,wd:Q14073567,wd:Q2444451,wd:Q42962623,wd:Q61745168,wd:Q15238535,wd:Q33499497,wd:Q27924973,wd:Q21191150,
          wd:Q5446577,wd:Q6619719,wd:Q111304273,wd:Q3046146,wd:Q16705943,wd:Q4335750,wd:Q17468125,wd:Q19791817,wd:Q10260065,wd:Q1194951,wd:Q1965565,wd:Q6070836,
          wd:Q15331236,wd:Q3287136),\"ORG\",
        IF(?clase IN (wd:Q10298203,wd:Q190327,wd:Q195,wd:Q15731648,wd:Q182053,wd:Q6619802,wd:Q64493576,wd:Q1195697,wd:Q746591,wd:Q4359253,wd:Q6103015,wd:Q50614237,wd:Q189977,
          wd:Q15706911,wd:Q23010327,wd:Q1412386,wd:Q100325250,wd:Q59828901,wd:Q35197,wd:Q7419514,wd:Q108896773,wd:Q15909505,wd:Q27104510,wd:Q16694396,wd:Q54857328,
          wd:Q5463565,wd:Q15053464,wd:Q11996080,wd:Q17709301,wd:Q148493,wd:Q11032077,wd:Q74574,wd:Q30237636,wd:Q10352310,wd:Q15306849,wd:Q6041439,wd:Q1125911,wd:Q18545,
          wd:Q897229,wd:Q18237053,wd:Q87370201,wd:Q845053,wd:Q18395215),\"OBJ\",
        IF(?clase IN (wd:Q24573088,wd:Q15702752,wd:Q3246774,wd:Q22442634,wd:Q2541847,wd:Q30167070,wd:Q30167980,wd:Q30167264,wd:Q15832079,wd:Q3434376,wd:Q3244549,wd:Q42058680,wd:Q2159960,
          wd:Q30170627,wd:Q15304430,wd:Q15728054,wd:Q15831457,wd:Q3521824,wd:Q15298195,wd:Q30302594,wd:Q27229996,wd:Q2551561,wd:Q186361,wd:Q2239243,wd:Q69379490,wd:Q3542731,
          wd:Q2658345,wd:Q845696,wd:Q21192438,wd:Q15707583,wd:Q30301487,wd:Q115526522,wd:Q15298221,wd:Q27120684,wd:Q15728050,wd:Q18965,wd:Q15720625,wd:Q2537344,wd:Q39026077),\"NAT\",
        IF(?clase IN (wd:Q14897293,wd:Q15831596),\"MIX-MESS\",
        IF(?clase IN (wd:Q19826142,wd:Q18814068,wd:Q2043034,wd:Q19826163,wd:Q19826161,wd:Q55488,wd:Q61508291,wd:Q15796005,wd:Q63959432,wd:Q16363493,wd:Q208361,wd:Q96240572,
          wd:Q1964689,wd:Q87370199,wd:Q89375434,wd:Q17682891,wd:Q52085914,wd:Q33296715,wd:Q29587254,wd:Q20751022,wd:Q15720793,wd:Q105672916,wd:Q15709963,wd:Q15709969,
          wd:Q1133667,wd:Q63959446,wd:Q105672958,wd:Q3895768,wd:Q82551957,wd:Q18058299,wd:Q105672943,wd:Q18948595,wd:Q60875215,wd:Q89375447),\"LUG\",
        IF(?clase IN (wd:Q844450,wd:Q501390,wd:Q1781513,wd:Q14136353,wd:Q20037067,wd:Q52699397,wd:Q56512781,wd:Q15707521,wd:Q15707532,wd:Q32859549,wd:Q21130120,wd:Q17198419,wd:Q925144),\"CULT\",
        IF(?clase IN (wd:Q1047698,wd:Q28872880,wd:Q21505007,wd:Q109411,wd:Q108048090,wd:Q64960594,wd:Q917362,wd:Q60466213,wd:Q15708422,wd:Q1647221,wd:Q690768,wd:Q2623733,
          wd:Q33293152,wd:Q9134,wd:Q1402016,wd:Q101541332,wd:Q3622170,wd:Q1999796,wd:Q54440109,wd:Q81741,wd:Q104698487,wd:Q17305127,wd:Q1149649,wd:Q1144504),\"ACC\",\"OTROS\")))))))))) AS ?macro)
} GROUP BY ?macro ORDER BY DESC (COUNT(?clase)) (SUM(?num_items))""";
  <https://purl.expasy.org/sparql-examples/ontology#bigdata_query> """SELECT ?macro (COUNT(DISTINCT ?clase) as ?num_clases) (COUNT(DISTINCT ?item) AS ?total_items) WHERE {
    ?item wdt:P1080 wd:Q5410773 .
    ?item wdt:P31|wdt:P279|wdt:P361 ?clase .
    ?clase wdt:P279 ?superclase .
  SERVICE wikibase:label {bd:serviceParam wikibase:language \"es\",\"en\" .}
  BIND(
        IF(?clase IN (wd:Q66118879,wd:Q15298259,wd:Q181291,wd:Q1462606,wd:Q95074,wd:Q9303881,wd:Q5641611,wd:Q1056391,wd:Q2593744,wd:Q2338879,wd:Q15632617,wd:Q61002,wd:Q28020127,
          wd:Q2595584,wd:Q2753115,wd:Q12372870,wd:Q30174902,wd:Q20085850,wd:Q1569167,wd:Q3953096,wd:Q2087138,wd:Q5,wd:Q30061299,wd:Q1124812,wd:Q42056878,wd:Q5575572,
          wd:Q30167705,wd:Q3658341,wd:Q30147469,wd:Q17427986,wd:Q33295419,wd:Q33295822,wd:Q61750569,wd:Q33297169,wd:Q112242467,wd:Q154224,wd:Q2607197,wd:Q148401,wd:Q830248,
          wd:Q20529153,wd:Q33179355,wd:Q3375722,wd:Q6133514,wd:Q30174967,wd:Q15773347,wd:Q24286894), \"PER\", 
        IF(?clase IN (wd:Q4164871,wd:Q1931388,wd:Q1077857,wd:Q15635173,wd:Q247297,wd:Q4197743,wd:Q127843),\"PER-AT\",
        IF(?clase IN (wd:Q1791627,wd:Q13406463,wd:Q63032896),\"WIKIS\",
        IF(?clase IN (wd:Q5446565,wd:Q16979650,wd:Q6092436,wd:Q24577840,wd:Q3303128,wd:Q14514600,wd:Q3758946,wd:Q3967406,wd:Q21130150,wd:Q12271627,wd:Q112120197,wd:Q12713690,
          wd:Q60390514,wd:Q14623646,wd:Q933971,wd:Q56850094,wd:Q55586013,wd:Q14073567,wd:Q2444451,wd:Q42962623,wd:Q61745168,wd:Q15238535,wd:Q33499497,wd:Q27924973,wd:Q21191150,
          wd:Q5446577,wd:Q6619719,wd:Q111304273,wd:Q3046146,wd:Q16705943,wd:Q4335750,wd:Q17468125,wd:Q19791817,wd:Q10260065,wd:Q1194951,wd:Q1965565,wd:Q6070836,
          wd:Q15331236,wd:Q3287136),\"ORG\",
        IF(?clase IN (wd:Q10298203,wd:Q190327,wd:Q195,wd:Q15731648,wd:Q182053,wd:Q6619802,wd:Q64493576,wd:Q1195697,wd:Q746591,wd:Q4359253,wd:Q6103015,wd:Q50614237,wd:Q189977,
          wd:Q15706911,wd:Q23010327,wd:Q1412386,wd:Q100325250,wd:Q59828901,wd:Q35197,wd:Q7419514,wd:Q108896773,wd:Q15909505,wd:Q27104510,wd:Q16694396,wd:Q54857328,
          wd:Q5463565,wd:Q15053464,wd:Q11996080,wd:Q17709301,wd:Q148493,wd:Q11032077,wd:Q74574,wd:Q30237636,wd:Q10352310,wd:Q15306849,wd:Q6041439,wd:Q1125911,wd:Q18545,
          wd:Q897229,wd:Q18237053,wd:Q87370201,wd:Q845053,wd:Q18395215),\"OBJ\",
        IF(?clase IN (wd:Q24573088,wd:Q15702752,wd:Q3246774,wd:Q22442634,wd:Q2541847,wd:Q30167070,wd:Q30167980,wd:Q30167264,wd:Q15832079,wd:Q3434376,wd:Q3244549,wd:Q42058680,wd:Q2159960,
          wd:Q30170627,wd:Q15304430,wd:Q15728054,wd:Q15831457,wd:Q3521824,wd:Q15298195,wd:Q30302594,wd:Q27229996,wd:Q2551561,wd:Q186361,wd:Q2239243,wd:Q69379490,wd:Q3542731,
          wd:Q2658345,wd:Q845696,wd:Q21192438,wd:Q15707583,wd:Q30301487,wd:Q115526522,wd:Q15298221,wd:Q27120684,wd:Q15728050,wd:Q18965,wd:Q15720625,wd:Q2537344,wd:Q39026077),\"NAT\",
        IF(?clase IN (wd:Q14897293,wd:Q15831596),\"MIX-MESS\",
        IF(?clase IN (wd:Q19826142,wd:Q18814068,wd:Q2043034,wd:Q19826163,wd:Q19826161,wd:Q55488,wd:Q61508291,wd:Q15796005,wd:Q63959432,wd:Q16363493,wd:Q208361,wd:Q96240572,
          wd:Q1964689,wd:Q87370199,wd:Q89375434,wd:Q17682891,wd:Q52085914,wd:Q33296715,wd:Q29587254,wd:Q20751022,wd:Q15720793,wd:Q105672916,wd:Q15709963,wd:Q15709969,
          wd:Q1133667,wd:Q63959446,wd:Q105672958,wd:Q3895768,wd:Q82551957,wd:Q18058299,wd:Q105672943,wd:Q18948595,wd:Q60875215,wd:Q89375447),\"LUG\",
        IF(?clase IN (wd:Q844450,wd:Q501390,wd:Q1781513,wd:Q14136353,wd:Q20037067,wd:Q52699397,wd:Q56512781,wd:Q15707521,wd:Q15707532,wd:Q32859549,wd:Q21130120,wd:Q17198419,wd:Q925144),\"CULT\",
        IF(?clase IN (wd:Q1047698,wd:Q28872880,wd:Q21505007,wd:Q109411,wd:Q108048090,wd:Q64960594,wd:Q917362,wd:Q60466213,wd:Q15708422,wd:Q1647221,wd:Q690768,wd:Q2623733,
          wd:Q33293152,wd:Q9134,wd:Q1402016,wd:Q101541332,wd:Q3622170,wd:Q1999796,wd:Q54440109,wd:Q81741,wd:Q104698487,wd:Q17305127,wd:Q1149649,wd:Q1144504),\"ACC\",\"OTROS\")))))))))) AS ?macro)
} GROUP BY ?macro ORDER BY DESC (COUNT(?clase)) (SUM(?num_items))""";
  <https://purl.expasy.org/sparql-examples/ontology#federatesWith> <http://wikiba.se/ontology#label>;
  schema:target <https://query.wikidata.org/sparql> .
